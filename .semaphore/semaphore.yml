version: v1.0
name: Example
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
  containers:
    - name: main
      image: 'semaphoreci/ruby:2.7.1-node-browsers'
blocks:
  - name: Chrome
    task:
      jobs:
        - name: chrome 83.x
          commands:
            - 'echo "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main" | sudo tee /etc/apt/sources.list.d/google-chrome.list'
            - 'sudo wget https://dl.google.com/linux/linux_signing_key.pub && sudo apt-key add linux_signing_key.pub'
            - sudo apt-get update && sudo apt-get remove -y google-chrome-stable && sudo apt-get install -y google-chrome-beta
            - google-chrome --version
            - export CHROMEDRIVER_VERSION="83.0.4103.14"
            - 'curl --silent --show-error --location --fail --retry 3 --output /tmp/chromedriver_linux64.zip "http://chromedriver.storage.googleapis.com/$CHROMEDRIVER_VERSION/chromedriver_linux64.zip"'
            - cd /tmp && unzip chromedriver_linux64.zip && rm -rf chromedriver_linux64.zip && sudo mv chromedriver /usr/local/bin/chromedriver
            - sudo chmod +x /usr/local/bin/chromedriver
            - chromedriver --version
